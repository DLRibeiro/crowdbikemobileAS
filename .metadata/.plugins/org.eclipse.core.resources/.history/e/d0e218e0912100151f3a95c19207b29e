package com.software.project.cep.subscribe;

import java.util.Map;

import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.stereotype.Component;

import com.software.project.amqp.MessageQueueManager;
import com.software.project.util.ApplicationContextProvider;


@Component
public class MonitorEventVehicle implements StatementSubscriber {

	    /** Logger */
	    private static Logger LOG = LoggerFactory.getLogger(MonitorEventVehicle.class);
	   
	    /**
	     * {@inheritDoc}
	     */
		@Override
		public String getStatement() {
			// TODO Auto-generated method stub
			
			return "create window Vehicle.win:keepall() as Select imei,lat,lng From VehiclePosition";
			//return "create window Vehicle.win:time(10 sec) as Select imei,lat,lng From VehiclePosition";
		}

		/**
	     * Listener method called when Esper has detected a pattern match.
		 * @throws Exception 
	     */
	    public void update(Map<String, Double> eventMap) throws Exception {
	    	
	    	

	        StringBuilder sb = new StringBuilder();
	        sb.append("---------------------------------");
	        sb.append("\n- [MONITOR] imei = " + eventMap.get("imei"));
	        sb.append("\n- [MONITOR] lat = " + eventMap.get("lat"));
	        sb.append("\n- [MONITOR] lng = " + eventMap.get("lng"));
	        sb.append("\n---------------------------------");
	        LOG.debug(sb.toString());
	      
	    }

}
